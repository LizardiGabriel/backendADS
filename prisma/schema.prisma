generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id_usuario               Int        @id @default(autoincrement())
  email_usuario            String     @unique
  password_usuario         String
  nombre_usuario           String
  apellido_paterno_usuario String
  apellido_materno_usuario String
  telefono_usuario         Int
  rol_usuario              RolUsuario
  foto_usuario             String
  Reunion                  Reunion[]
}

enum RolUsuario {
  SuperAdmin
  Anfitrion
  Seguridad
}

model Sala {
  id_sala        Int         @id @default(autoincrement())
  nombre_sala    String
  capacidad_sala Int
  piso_sala      Int
  ubicacion_sala String
  estatus_sala   EstatusSala
  Reunion        Reunion[]
}

enum EstatusSala {
  NoDisponible
  Disponible
}

model Reunion {
  id_reunion          Int      @id @default(autoincrement())
  id_usuario          Int
  id_sala             Int
  titulo_reunion      String
  fecha_reunion       DateTime
  descripcion_reunion String

  usuario    Usuario      @relation(fields: [id_usuario], references: [id_usuario])
  sala       Sala         @relation(fields: [id_sala], references: [id_sala])
  Invitacion Invitacion[]
  Acceso     Acceso[]
}

model Invitado {
  id_invitado               Int              @id @default(autoincrement())
  nombre_invitado           String
  apellido_paterno_invitado String
  apellido_materno_invitado String
  email_invitado            String           @unique
  password_invitado         String
  telefono_invitado         Int
  empresa_invitado          String
  foto_invitado             String
  identificacion_invitado   String
  es_colado_invitado        Boolean
  habilitado                Boolean
  Invitacion                Invitacion[]
  Colado                    Colado[]
  ColadoInvitado            ColadoInvitado[]
}

model Invitacion {
  id_invitacion Int        @id @default(autoincrement())
  id_reunion    Int
  id_invitado   Int
  qr_acceso     String
  habilitado    Habilitado

  reunion                Reunion                  @relation(fields: [id_reunion], references: [id_reunion])
  invitado               Invitado                 @relation(fields: [id_invitado], references: [id_invitado])
  Acceso                 Acceso[]
  DispositivoElectronico DispositivoElectronico[]
  Acompaniante           Acompaniante[]
  Automovil              Automovil[]
}

enum Habilitado {
  Si
  No
}

model Acceso {
  id_acceso           Int       @id @default(autoincrement())
  id_invitacion       Int
  id_reunion          Int
  nota_acceso         String?
  hora_entrada_acceso DateTime
  hora_salida_acceso  DateTime?

  invitacion                   Invitacion                     @relation(fields: [id_invitacion], references: [id_invitacion])
  reunion                      Reunion                        @relation(fields: [id_reunion], references: [id_reunion])
  AccesoDispositivoElectronico AccesoDispositivoElectronico[]
}

model DispositivoElectronico {
  id_dispositivo_electronico       Int    @id @default(autoincrement())
  id_invitacion                    Int
  no_serie_dispositivo_electronico String
  modelo_dispositivo_electronico   String
  marca_dispositivo_electronico    String

  invitacion                   Invitacion                     @relation(fields: [id_invitacion], references: [id_invitacion])
  AccesoDispositivoElectronico AccesoDispositivoElectronico[]
}

model Acompaniante {
  id_acompaniante               Int    @id @default(autoincrement())
  id_invitacion                 Int
  nombre_acompaniante           String
  apellido_paterno_acompaniante String
  apellido_materno_acompaniante String
  email_acompaniante            String

  invitacion Invitacion @relation(fields: [id_invitacion], references: [id_invitacion])
}

model Automovil {
  id_automovil        Int    @id @default(autoincrement())
  id_invitacion       Int
  color_automovil     String
  matricula_automovil String
  marca_automovil     String
  modelo_automovil    String

  invitacion Invitacion @relation(fields: [id_invitacion], references: [id_invitacion])
}

model Colado {
  id_colado   Int @id @default(autoincrement())
  id_invitado Int

  invitado       Invitado         @relation(fields: [id_invitado], references: [id_invitado])
  ColadoInvitado ColadoInvitado[]
}

model ColadoInvitado {
  id_colado_invitado Int @id @default(autoincrement())
  id_colado          Int
  id_invitado        Int

  colado   Colado   @relation(fields: [id_colado], references: [id_colado])
  invitado Invitado @relation(fields: [id_invitado], references: [id_invitado])
}

model AccesoDispositivoElectronico {
  id_acceso_dispositivo_electronico Int     @id @default(autoincrement())
  id_acceso                         Int
  id_dispositivo_electronico        Int
  check                             Boolean

  acceso                  Acceso                 @relation(fields: [id_acceso], references: [id_acceso])
  dispositivo_electronico DispositivoElectronico @relation(fields: [id_dispositivo_electronico], references: [id_dispositivo_electronico])
}
